## 函数API

### poll

```c
int poll(struct pollfd *fds, nfds_t nfds, int timeout);
```

#### 描述

- `poll` 函数，类似于 `select` 函数，但提供更强大的功能和灵活性它可以监视多个文件描述符是否处于可读、可写或异常等状态，从而实现非阻塞的 I/O 操作

#### 参数

- `fds`：一个指向 `struct pollfd` 数组的指针，每个结构体描述一个要监视的文件描述符及其关注的事件
- `nfds`：数组中元素的数量，即要监视的文件描述符的个数
- `timeout`：超时时间，以毫秒为单位设置为负值表示无限等待，设置为 0 表示立即返回，设置为正值表示等待指定毫秒数后返回

#### 返回值

- 如果有文件描述符处于可读、可写或有异常情况发生，返回大于 0 的整数，表示就绪的文件描述符数量
- 如果超时时间内没有任何事件发生，返回 0
- 如果出现错误，返回 -1，并设置 `errno`

---

## 结构体说明

### struct pollfd

#### 成员说明

- `fd`：要监视的文件描述符，当 `poll` 函数调用时，会检查这个文件描述符是否就绪
- `events`：表示关注的事件，是一个位掩码，可以使用以下常量进行设置：
  - `POLLIN`：表示文件描述符可读，当有数据可以从文件描述符读取时，会设置该标志
  - `POLLOUT`：表示文件描述符可写，当可以向文件描述符写入数据时，会设置该标志
  - `POLLERR`：表示文件描述符发生错误，当文件描述符出现错误时，会设置该标志
  - `POLLHUP`：表示文件描述符挂起，当文件描述符挂起（通常是对端关闭连接）时，会设置该标志
- `revents`：表示实际发生的事件，由系统设置，在调用 `poll` 函数后，会填充这个字段，以指示实际发生了哪些事件